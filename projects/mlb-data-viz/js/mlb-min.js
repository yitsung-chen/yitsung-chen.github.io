var playerId,currentSeason,linePreMax,seasonStatsArray=[],seasonStatsClean=[],barsIndexClicked="default",lineLegPos=[],lineLegNew=[],resetTimer=0;function search(){var e=document.getElementById("preloader"),t=document.getElementById("search-pane"),n=(document.getElementById("return-btn"),document.getElementById("search-icon"),document.getElementById("dash-header"),"'Y'"),a="";""!==document.getElementById("search-bar").value&&(a=document.getElementById("search-bar").value,n=document.getElementById("toggle").checked?"'Y'":"'N'",fadeOut(t,17),fadeIn(e,"block",19),playerIdParse(e,a,n))}function playerIdParse(e,t,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var r=JSON.parse(a.responseText).search_player_all.queryResults.row;if(void 0===r)return fadeOut(e,17),document.querySelector(".query-result").innerHTML="<b><i>"+t+"</i></b>",fadeIn(document.getElementById("error-msg"),"inline-block",20),void resetContent();playerInfoParse(playerId=r.length>1?r[0].player_id:r.player_id,n,e,t)}else if(500==a.status)return fadeOut(e,17),document.querySelector(".system-error-name").innerHTML="<b><i>"+t+"'s</i></b>",fadeIn(document.getElementById("system-error-msg"),"inline-block",20),void resetContent()},a.open("GET","https://lookup-service-prod.mlb.com/json/named.search_player_all.bam?sport_code='mlb'&active_sw="+n+"&name_part='"+t+"%25'&search_player_all.col_in=player_id"),a.send()}function playerInfoParse(e,t,n,a){var r,o=new XMLHttpRequest,s=["<th>H</th>","<th>1B</th>","<th>2B</th>","<th>3B</th>","<th>HR</th>","<th>RBI</th>","<th>SB</th>","<th>K</th>","<th>AVG</th>","<th>SLG</th>","<th>OBP</th>","<th>OPS</th>"],l=["<th>W</th>","<th>SV</th>","<th>HLD</th>","<th>SO</th>","<th>AO</th>","<th>GO</th>","<th>BB</th>","<th>K%</th>","<th>ERA</th>","<th>WHIP</th>","<th>WPCT</th>"],i=document.getElementById("metrics-title");o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){if(""===(r=JSON.parse(o.responseText).player_info.queryResults.row).pro_debut_date||void 0===r)return fadeOut(n,17),document.querySelector(".query-result").innerHTML="<b><i>"+a+"</i></b>",fadeIn(document.getElementById("error-msg"),"inline-block",20),void resetContent();currentSeason="'Y'"===t&&""===r.end_date?(new Date).getFullYear():Number(r.end_date.slice(0,4)),"P"!==r.primary_position_txt?i.innerHTML=s.join(""):i.innerHTML=l.join(""),careerStats(e,r,void 0),playerTeamParse(e,r,currentSeason,n)}},o.open("GET","https://lookup-service-prod.mlb.com/json/named.player_info.bam?sport_code='mlb'&player_id='"+e+"'&player_info.col_in=primary_position_txt&player_info.col_in=bats&player_info.col_in=throws&player_info.col_in=age&player_info.col_in=height_feet&player_info.col_in=height_inches&player_info.col_in=weight&player_info.col_in=pro_debut_date&player_info.col_in=name_display_first_last&player_info.col_in=jersey_number&player_info.col_in=end_date&player_info.col_in=birth_date&player_info.col_in=death_date"),o.send()}function playerTeamParse(e,t,n,a){var r,o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){if(void 0===(r=JSON.parse(o.responseText).player_teams.queryResults.row))return void playerTeamParse(e,t,--n,a);if(r.length>1){var s=!0,l=0;for(r=JSON.parse(o.responseText).player_teams.queryResults.row[l];s;)if("mlb"!==r.sport_code.toLowerCase()){if(l++,void 0===(r=JSON.parse(o.responseText).player_teams.queryResults.row[l]))return playerTeamParse(e,t,--n,a),void(s=!1)}else s=!1}else{if("mlb"!==r.sport_code.toLowerCase())return void playerTeamParse(e,t,--n,a);r=JSON.parse(o.responseText).player_teams.queryResults.row}playerInfoInsert(r,t),InfoDisplay(e,t,a)}},o.open("GET","https://lookup-service-prod.mlb.com/json/named.player_teams.bam?season='"+String(n)+"'&player_id='"+e+"'&player_teams.col_in=league&player_teams.col_in=team_abbrev&player_teams.col_in=sport_code"),o.send()}function playerInfoInsert(e,t){var n=playerAgeCalculator(t),a=document.getElementsByClassName("grid-item"),r=["Position : "+t.primary_position_txt.bold(),"B / T : "+t.bats.bold()+" / "+t.throws.bold(),"Age : "+n,"Height / Weight : "+t.height_feet.bold()+"'"+t.height_inches.bold()+" / "+t.weight.bold()+" lbs","Debut : "+t.pro_debut_date.slice(0,10).bold(),"League : "+e.league.bold(),"Team : "+e.team_abbrev.bold()];document.getElementById("player-info").querySelector("h1").classList.add("player-name"),""===t.jersey_number||isNaN(Number(t.jersey_number))?document.getElementsByClassName("player-name")[0].innerHTML=t.name_display_first_last:document.getElementsByClassName("player-name")[0].innerHTML=t.name_display_first_last+"&nbsp;&nbsp;#<span>"+t.jersey_number+"</span>";for(let e=0;e<a.length;e++)a[e].innerHTML=r[e]}function careerStats(e,t,n){var a,r,o=new XMLHttpRequest,s=document.getElementById("stats-container"),l=document.getElementById("btn-group"),i=document.querySelector(".stats-header"),d=document.querySelector(".stats-sub-header"),c=document.getElementById("regular"),u=document.getElementById("s-avg"),m=document.getElementById("m-avg"),g=document.getElementById("w-avg");r="P"!==t.primary_position_txt?"&"+(a="sport_career_hitting")+".col_in=h&"+a+".col_in=hr&"+a+".col_in=rbi&"+a+".col_in=sb&"+a+".col_in=g&"+a+".col_in=so&"+a+".col_in=avg&"+a+".col_in=slg&"+a+".col_in=obp&"+a+".col_in=xbh&"+a+".col_in=tb":"&"+(a="sport_career_pitching")+".col_in=w&"+a+".col_in=sv&"+a+".col_in=hld&"+a+".col_in=so&"+a+".col_in=bb&"+a+".col_in=era&"+a+".col_in=whip&"+a+".col_in=wpct&"+a+".col_in=qs&"+a+".col_in=g&"+a+".col_in=gs&"+a+".col_in=l&"+a+".col_in=ao&"+a+".col_in=go&"+a+".col_in=tbf",o.onreadystatechange=function(){4==o.readyState&&200==o.status&&((n=JSON.parse(o.responseText)[String(a)].queryResults.row).kpct=Math.round(Number(n.so)/Number(n.tbf)*1e3)/1e3,careerStatsParse(t,c,u,m,g,n),setTimeout(function(){fadeIn(i,"block",16),fadeIn(d,"block",16),fadeIn(s,"grid",16),fadeIn(l,"grid",16)},60))},o.open("GET","https://lookup-service-prod.mlb.com/json/named."+a+".bam?league_list_id='mlb'&game_type='R'&player_id='"+e+"'"+r),o.send()}function seasonStats(e,t){var n,a,r,o=new XMLHttpRequest,s=document.querySelectorAll(".grid-item")[0].innerText.slice(-1),l=document.querySelectorAll(".grid-item")[4].innerText.slice(8,12),i=document.getElementById("dash-preloader"),d=document.getElementById("bar-chart"),c=document.getElementById("donut-chart"),u=document.getElementById("line-chart");r=t,a="P"!==s?"&"+(n="sport_hitting_tm")+".col_in=h&"+n+".col_in=so&"+n+".col_in=hr&"+n+".col_in=rbi&"+n+".col_in=sb&"+n+".col_in=g&"+n+".col_in=so&"+n+".col_in=avg&"+n+".col_in=ops&"+n+".col_in=slg&"+n+".col_in=obp&"+n+".col_in=xbh&"+n+".col_in=tb&"+n+".col_in=season&"+n+".col_in=team_abbrev&"+n+".col_in=ab&"+n+".col_in=hbp&"+n+".col_in=sf&"+n+".col_in=go&"+n+".col_in=ao&"+n+".col_in=bb":"&"+(n="sport_pitching_tm")+".col_in=w&"+n+".col_in=sv&"+n+".col_in=hld&"+n+".col_in=so&"+n+".col_in=bb&"+n+".col_in=era&"+n+".col_in=whip&"+n+".col_in=qs&"+n+".col_in=g&"+n+".col_in=gs&"+n+".col_in=l&"+n+".col_in=season&"+n+".col_in=team_abbrev&"+n+".col_in=go&"+n+".col_in=ao&"+n+".col_in=h&"+n+".col_in=ip&"+n+".col_in=er&"+n+".col_in=tbf",o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var a=JSON.parse(o.responseText)[n].queryResults.row;return void 0===a?r<=Number(l)?void 0:void seasonStats(e,--t):r<=Number(l)?(seasonStatsParse(r,s,a),fadeOut(i,13),dashboardBuilder("default"),void setTimeout(function(){fadeIn(d,"",15),fadeIn(c,"",15),fadeIn(u,"",15)},100)):(seasonStatsParse(r,s,a),5===seasonStatsArray.length?(fadeOut(i,13),dashboardBuilder("default"),void setTimeout(function(){fadeIn(d,"",15),fadeIn(c,"",15),fadeIn(u,"",15)},100)):void seasonStats(e,--t))}},o.open("GET","https://lookup-service-prod.mlb.com/json/named."+n+".bam?league_list_id='mlb'&game_type='R'&season='"+String(r)+"'&player_id='"+e+"'"+a),o.send()}function InfoDisplay(e,t,n){var a=document.getElementById("dash-header"),r=new Image,o=document.getElementById("player-pic"),s=document.getElementById("return-btn");document.getElementById("w-avg");r.onload=function(){fadeOut(n,50),setTimeout(function(){fadeIn(a,"block",17),fadeIn(s,"inline-block",17),window.scrollTo(0,0)},180),o.src=this.src},"P"===t.primary_position_txt?r.src="https://getdrawings.com/img/baseball-player-silhouette-vector-24.jpg":r.src="https://getdrawings.com/img/baseball-player-silhouette-vector-4.jpg"}function scrollDown(e,t){var n=window.pageYOffset,a=window.setInterval(function(){document.getElementById(e).offsetTop>n?window.scrollTo(0,n+=document.getElementById(e).offsetTop/t):(window.clearInterval(a),"yes")},t)}function fadeIn(e,t="",n){e.style.opacity=0;var a=0;if(""===t)var r=window.setInterval(function(){Number(e.style.opacity)<1?(a+=1/n,e.style.opacity=a):(e.style.opacity=1,window.clearInterval(r))},n);else r=window.setInterval(function(){Number(e.style.opacity)<1?(a+=1/n,e.style.opacity=a,e.style.display=t):(e.style.opacity=1,window.clearInterval(r))},n)}function fadeOut(e,t,n=""){e.style.opacity=1;var a=1;if(""===n)var r=window.setInterval(function(){Number(e.style.opacity)>0?(a-=1/t,e.style.opacity=a,e.style.display="none"):(e.style.opacity=0,window.clearInterval(r))},t);else r=window.setInterval(function(){Number(e.style.opacity)>0?(a-=1/t,e.style.opacity=a):(e.style.opacity=0,window.clearInterval(r))},t)}function playerAgeCalculator(e){if(""===e.death_date)return String(e.age).bold();var t=new Date(e.death_date.slice(0,10)),n=new Date(e.birth_date.slice(0,10));return t.getMonth()>n.getMonth()?String(t.getYear()-n.getYear()).bold()+" ( death )".italics():t.getMonth()===n.getMonth()&&t.getDay()>n.getDay()?String(t.getYear()-n.getYear()).bold()+" ( death )".italics():String(t.getYear()-n.getYear()-1).bold()+" ( death )".italics()}function resetContent(){var e=document.getElementById("dash-header"),t=document.getElementById("return-btn"),n=document.getElementById("search-icon"),a=document.getElementById("regular"),r=document.getElementById("s-avg"),o=document.getElementById("m-avg"),s=document.getElementById("w-avg"),l=document.getElementById("stats-container"),i=document.getElementById("dashboard-container"),d=document.getElementById("dash-preloader"),c=document.getElementById("bar-chart"),u=document.getElementById("donut-chart"),m=document.getElementById("line-chart"),g=document.getElementById("bar-metrics-option"),h=document.getElementById("line-metrics-option"),b=document.getElementsByClassName("donut-tooltip")[0],p=document.getElementsByClassName("line-tooltip")[0];void 0!==b&&b.remove(),void 0!==p&&p.remove(),lineLegNew=[],lineLegPos=[],g.innerHTML="",h.innerHTML="",seasonStatsArray=[],seasonStatsClean=[],uniqueSeasons=[],fadeIn(d,"block",10);for(let e=0;e<document.getElementsByClassName("grid-item").length;e++)document.getElementsByClassName("grid-item")[e].innerText="";void 0!==document.getElementsByClassName("player-name")[0]&&(document.getElementsByClassName("player-name")[0].innerText="",document.getElementById("player-info").querySelector("h1").classList.remove("player-name"),fadeOut(e,17),fadeOut(t,17),fadeOut(n,17),fadeOut(l,17),fadeOut(i,17),fadeOut(c,17,"display-unchanged"),fadeOut(u,17,"display-unchanged"),fadeOut(m,17,"display-unchanged"),a.innerHTML="",r.innerHTML="",o.innerHTML="",s.innerHTML="",d3.select("#bar-chart").selectAll("svg").remove(),d3.select("#donut-chart").selectAll("svg").remove(),d3.select("#line-chart").selectAll("svg").remove(),d3.select("#donut-season").remove())}function pageLoader(){var e=document.querySelector("body"),t=document.getElementById("header-logo"),n=new Image;e.style.opacity=0,n.onload=function(){t.src=this.src,fadeIn(e,"block",17)},n.src="https://www.mlbstatic.com/team-logos/league-on-dark/1.svg"}function careerStatsParse(e,t,n,a,r,o){if("P"!==e.primary_position_txt){var s=162/Number(o.g),l=27/Number(o.g),i=6.75/Number(o.g),d=String(Number(o.h)-Number(o.xbh)),c=String(2*Number(o.xbh)+Number(o.hr)-Number(o.tb)+Number(o.h)),u=String(Number(o.tb)-Number(o.h)-Number(o.xbh)-2*Number(o.hr));t.innerHTML="<td>"+o.h+"</td><td>"+d+"</td><td>"+c+"</td><td>"+u+"</td><td>"+o.hr+"</td><td>"+o.rbi+"</td><td>"+o.sb+"</td><td>"+o.so+"</td><td>"+o.avg+"</td><td>"+o.slg+"</td><td>"+o.obp+"</td><td>"+(Number(o.slg)+Number(o.obp)).toFixed(3)+"</td>",n.innerHTML="<td>"+String(Math.round(Number(o.h)*s*10)/10)+"</td><td>"+String(Math.round(Number(d)*s*10)/10)+"</td><td>"+String(Math.round(Number(c)*s*10)/10)+"</td><td>"+String(Math.round(Number(u)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.hr)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.rbi)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.sb)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.so)*s*10)/10)+"</td><td>"+o.avg+"</td><td>"+o.slg+"</td><td>"+o.obp+"</td><td>"+(Number(o.slg)+Number(o.obp)).toFixed(3)+"</td>",a.innerHTML="<td>"+String(Math.round(Number(o.h)*l*10)/10)+"</td><td>"+String(Math.round(Number(d)*l*10)/10)+"</td><td>"+String(Math.round(Number(c)*l*10)/10)+"</td><td>"+String(Math.round(Number(u)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.hr)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.rbi)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.sb)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.so)*l*10)/10)+"</td><td>"+o.avg+"</td><td>"+o.slg+"</td><td>"+o.obp+"</td><td>"+(Number(o.slg)+Number(o.obp)).toFixed(3)+"</td>",r.innerHTML="<td>"+String(Math.round(Number(o.h)*i*10)/10)+"</td><td>"+String(Math.round(Number(d)*i*10)/10)+"</td><td>"+String(Math.round(Number(c)*i*10)/10)+"</td><td>"+String(Math.round(Number(u)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.hr)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.rbi)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.sb)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.so)*i*10)/10)+"</td><td>"+o.avg+"</td><td>"+o.slg+"</td><td>"+o.obp+"</td><td>"+(Number(o.slg)+Number(o.obp)).toFixed(3)+"</td>"}else{var m=(100*o.kpct).toFixed(1)+"%";if(isNaN(Number(o.hld))||0===Number(o.hld))var g="0";else g=o.hld;if(0===Number(o.w))var h="0.000";else if(Number(o.w)/(Number(o.l)+Number(o.w))==1)h="1.000";else h=String(Math.round(Number(o.w)/(Number(o.l)+Number(o.w))*1e3)/1e3).slice(0);(isNaN(Number(o.ao))||0===Number(o.ao))&&(o.ao="0"),(isNaN(Number(o.go))||0===Number(o.go))&&(o.go="0");s=68/(Number(o.g)+Number(o.gs)),l=11.33/(Number(o.g)+Number(o.gs)),i=2.8325/(Number(o.g)+Number(o.gs));t.innerHTML="<td>"+o.w+"</td><td>"+o.sv+"</td><td>"+g+"</td><td>"+o.so+"</td><td>"+o.ao+"</td><td>"+o.go+"</td><td>"+o.bb+"</td><td>"+m+"</td><td>"+o.era+"</td><td>"+o.whip+"</td><td>"+h+"</td>",n.innerHTML="<td>"+String(Math.round(Number(o.w)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.sv)*s*10)/10)+"</td><td>"+String(Math.round(Number(g)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.so)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.ao)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.go)*s*10)/10)+"</td><td>"+String(Math.round(Number(o.bb)*s*10)/10)+"</td><td>"+m+"</td><td>"+o.era+"</td><td>"+o.whip+"</td><td>"+h+"</td>",a.innerHTML="<td>"+String(Math.round(Number(o.w)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.sv)*l*10)/10)+"</td><td>"+String(Math.round(Number(g)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.so)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.ao)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.go)*l*10)/10)+"</td><td>"+String(Math.round(Number(o.bb)*l*10)/10)+"</td><td>"+m+"</td><td>"+o.era+"</td><td>"+o.whip+"</td><td>"+h+"</td>",r.innerHTML="<td>"+String(Math.round(Number(o.w)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.sv)*i*10)/10)+"</td><td>"+String(Math.round(Number(g)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.so)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.ao)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.go)*i*10)/10)+"</td><td>"+String(Math.round(Number(o.bb)*i*10)/10)+"</td><td>"+m+"</td><td>"+o.era+"</td><td>"+o.whip+"</td><td>"+h+"</td>"}}function seasonStatsParse(e,t,n){if(void 0!==n.length){for(var a={},r=0;r<n.length;r++)"P"!==t&&(n[r]["1b"]=String(Number(n[r].h)-Number(n[r].xbh)),n[r]["2b"]=String(2*Number(n[r].xbh)+Number(n[r].hr)-Number(n[r].tb)+Number(n[r].h)),n[r]["3b"]=String(Number(n[r].tb)-Number(n[r].h)-Number(n[r].xbh)-2*Number(n[r].hr)));var o=Object.keys(n[0]);seasonStatsArray.unshift(n);for(var s=0;s<o.length;s++){var l=o[s];a[l]=n.reduce(function(e,t){if("ip"===l){var n=e+Number(t[l]),a=n-Math.round(n%1*10)/10,r=Math.round(n%1*10)/10;return a+Math.floor(r/.3)+Math.round(r%.3*10)/10}return"whip"===l||"era"===l?0:"avg"===l||"slg"===l||"obp"===l||"ops"===l?0:"team_abbrev"===l?e+" / "+t[l]:"season"===l?t[l]:e+Number(t[l])},0),a[l]=String(a[l])}if(a.team_abbrev=a.team_abbrev.slice(4),"P"===t){var i=Math.floor(Number(a.ip))+(10*Number(a.ip)-10*Math.floor(Number(a.ip)))/3;a.kpct=Math.round(Number(a.so)/Number(a.tbf)*1e3)/1e3,a.era=Math.round(Number(a.er)/i*9*100)/100,a.whip=Math.round((Number(a.bb)+Number(a.h))/i*100)/100}else{var d=1*Number(a["1b"])+2*Number(a["2b"])+3*Number(a["3b"])+4*Number(a.hr),c=Number(a.h)+Number(a.bb)+Number(a.hbp),u=Number(a.ab)+Number(a.bb)+Number(a.hbp)+Number(a.sf);a.avg=String(Math.round(Number(a.h)/Number(a.ab)*1e3)/1e3).slice(1),a.slg=String(Math.round(1e3*Number(d/a.ab))/1e3).slice(1),a.obp=String(Math.round(c/u*1e3)/1e3).slice(1),a.ops=String(Math.round(1e3*(Number(a.slg)+Number(a.obp)))/1e3).slice(1)}seasonStatsClean.unshift(a)}else"P"!==t?(n["1b"]=String(Number(n.h)-Number(n.xbh)),n["2b"]=String(2*Number(n.xbh)+Number(n.hr)-Number(n.tb)+Number(n.h)),n["3b"]=String(Number(n.tb)-Number(n.h)-Number(n.xbh)-2*Number(n.hr)),seasonStatsArray.unshift(n),seasonStatsClean.unshift(n)):(n.kpct=Math.round(Number(n.so)/Number(n.tbf)*1e3)/1e3,seasonStatsArray.unshift(n),seasonStatsClean.unshift(n))}function dashboardBuilder(e){for(var t=[],n=seasonStatsClean.length,a=Number(seasonStatsClean[0].season),r={};a<=Number(seasonStatsClean[n-1].season);)t.push(a),a++;var o=d3.select("#bar-chart").append("svg").attr("class","bar-chart"),s=d3.select("#donut-chart").append("svg").attr("class","donut-chart"),l=d3.select("body").append("div").attr("class","donut-tooltip").style("display","none");d3.select("#donut-chart").append("span").attr("id","donut-season").html('<p>Season :</p><p class = "seasonNum">&nbsp'+t[t.length-1]+"</p>");var i="default",d=d3.select("#line-chart").append("svg").attr("class","line-chart"),c=[document.getElementById("bar-chart").offsetHeight,document.getElementById("donut-chart").offsetHeight,document.getElementById("line-chart").offsetHeight],u=[document.getElementById("bar-chart").offsetWidth,document.getElementById("donut-chart").offsetWidth,document.getElementById("line-chart").offsetWidth];t=[...new Set(t)],dropdown(e,r,o,d,c,u,t),dashConstruction(e,r,o,l,i,s,d,c,u,t),window.addEventListener("resize",function(){var n=document.getElementById("bar-metrics-option"),a=document.getElementsByClassName("line-tooltip-container")[0],m=document.querySelector(".line-tooltip-dash"),g=document.querySelector(".line-tooltip");if(null!=a&&(console.log(a),a.remove()),null!=m&&m.remove(),null!=g&&g.remove(),lineLegPos=[],i=barsIndexClicked,void 0!==n){var h=n.options[n.selectedIndex].value.toLowerCase();e="k"===h?"so":h,o.selectAll("g").remove(),o.selectAll("rect").remove(),o.selectAll("text").remove(),d.selectAll("g").remove(),s.selectAll("g").remove(),c=[document.getElementById("bar-chart").offsetHeight,document.getElementById("donut-chart").offsetHeight,document.getElementById("line-chart").offsetHeight],u=[document.getElementById("bar-chart").offsetWidth,document.getElementById("donut-chart").offsetWidth,document.getElementById("line-chart").offsetWidth],dashConstruction(e,r,o,l,i,s,d,c,u,t)}})}function dashConstruction(e,t,n,a,r,o,s,l,i,d){var c=document.getElementById("return-btn"),u=document.getElementById("return-text");barConstruction(n,e,t,l,i,d,c,u),donutContruction("yes",r,o,a,i,l),lineConstruction(s,i,l,d),setTimeout(function(){0!==l[0]&&0!==l[1]||(d3.select("#bar-chart").selectAll("svg").remove(),d3.select("#donut-chart").selectAll("svg").remove(),d3.select("#line-chart").selectAll("svg").remove(),d3.select("div.toolTip").remove(),dashboardBuilder(e),fadeIn(c,"inline-block",10),fadeIn(u,"inline-block",10))},80),setTimeout(function(){"0"===c.style.opacity&&(fadeIn(c,"inline-block",10),fadeIn(u,"inline-block",10))},300)}function dropdown(e,t,n,a,r,o,s){var l=document.getElementById("bar-metrics-option"),i=document.getElementById("line-metrics-option"),d=document.querySelectorAll("#metrics-title>th"),c=document.getElementById("return-btn"),u=document.getElementById("return-text");if(""===l.innerHTML){for(var m=0;m<d.length-4;m++)l.innerHTML+='<option class="options" value="'+d[m].innerText+'">'+d[m].innerText+"</option>";if(l.addEventListener("change",function(){r=[document.getElementById("bar-chart").offsetHeight,document.getElementById("donut-chart").offsetHeight,document.getElementById("line-chart").offsetHeight],o=[document.getElementById("bar-chart").offsetWidth,document.getElementById("donut-chart").offsetWidth,document.getElementById("line-chart").offsetWidth];var e=l.options[l.selectedIndex].value.toLowerCase();updateBar("k"===e?"so":e,n,o,r,s,t,c,u)}),"W"===d[0].innerText)for(m=d.length-4;m<d.length-1;m++)i.innerHTML+='<input type="checkbox" class="line-chart-options" name="'+d[m].innerText+'" value="'+d[m].innerText+'" checked >&nbsp;<label for="'+d[m].innerText+'">'+d[m].innerText+"</label><br>";else for(m=d.length-4;m<d.length;m++)i.innerHTML+='<input type="checkbox" class="line-chart-options" name="'+d[m].innerText+'" value="'+d[m].innerText+'" checked >&nbsp;<label for="'+d[m].innerText+'">'+d[m].innerText+"</label><br>";var g=document.querySelectorAll("input.line-chart-options");for(m=0;m<g.length;m++)g[m].checked&&("k%"===g[m].value.toLowerCase()?lineLegNew.push("kpct"):lineLegNew.push(g[m].value.toLowerCase()));g.forEach(function(e){e.addEventListener("change",function(){r=[document.getElementById("bar-chart").offsetHeight,document.getElementById("donut-chart").offsetHeight,document.getElementById("line-chart").offsetHeight],o=[document.getElementById("bar-chart").offsetWidth,document.getElementById("donut-chart").offsetWidth,document.getElementById("line-chart").offsetWidth],lineLegNew=[];document.getElementById("bar-metrics-option");var e=document.querySelector(".line-tooltip-dash"),t=document.querySelector(".line-tooltip");void 0!==e&&e.remove(),void 0!==t&&t.remove(),this.checked||"K%"!==this.value?this.checked||(d3.selectAll("."+this.value.toLowerCase()).remove(),d3.selectAll(".line-legend.-"+this.value.toLowerCase()).attr("display","none")):(d3.selectAll(".kpct").remove(),d3.selectAll(".line-legend.-kpct").attr("display","none"));for(var n=0;n<g.length;n++)g[n].checked&&("k%"===g[n].value.toLowerCase()?lineLegNew.push("kpct"):lineLegNew.push(g[n].value.toLowerCase()));for(n=0;n<lineLegNew.length;n++)d3.select(".line-legend.-"+lineLegNew[n]).attr("transform",lineLegPos[n]);updateLine(this,g,a,o,r,s)})})}for(m=0;m<d.length;m++)"k"===d[m].innerText.toLowerCase()?t.so=Number(document.querySelectorAll("#s-avg>td")[m].innerText):t[d[m].innerText.toLowerCase()]=Number(document.querySelectorAll("#s-avg>td")[m].innerText)}function barYCoordInit(e,t,n,a,r){var o=d3.max(seasonStatsClean,e=>Number(e[r]));if(o>350){var s=d3.scaleLinear().domain([0,450]).range([a[0],a[0]-a[0]/1.2]),l=d3.axisLeft(s).tickValues([0,50,100,150,200,250,300,350,400,450]).tickSizeOuter(0)}else if(o>300&&o<=350){s=d3.scaleLinear().domain([0,400]).range([a[0],a[0]-a[0]/1.2]),l=d3.axisLeft(s).tickValues([0,50,100,150,200,250,300,350,400]).tickSizeOuter(0)}else if(o>200&&o<=300){s=d3.scaleLinear().domain([0,350]).range([a[0],a[0]-a[0]/1.2]),l=d3.axisLeft(s).tickValues([0,50,100,150,200,250,300,350]).tickSizeOuter(0)}else if(o>50&&o<=200){s=d3.scaleLinear().domain([0,250]).range([a[0],a[0]-a[0]/1.2]),l=d3.axisLeft(s).tickValues([0,50,100,150,200,250]).tickSizeOuter(0)}else if(o>30&&o<=50){s=d3.scaleLinear().domain([0,60]).range([a[0],a[0]-a[0]/1.2]),l=d3.axisLeft(s).tickValues([0,10,20,30,40,50,60]).tickSizeOuter(0)}else if(o>15&&o<=30){s=d3.scaleLinear().domain([0,40]).range([a[0],a[0]-a[0]/1.2]),l=d3.axisLeft(s).tickValues([0,10,20,30,40]).tickSizeOuter(0)}else{s=d3.scaleLinear().domain([0,25]).range([a[0],a[0]-a[0]/1.2]),l=d3.axisLeft(s).tickValues([0,5,10,15,20,25]).tickSizeOuter(0)}return[s,l,d3.axisLeft(s).ticks(4)]}function lineYCoordInit(e,t,n,a,r){document.querySelectorAll("input.line-chart-options");for(var o,s,l={},i=0,d=[],c=0;c<r.length;c++)l[r[c]]=d3.max(seasonStatsClean,e=>Number(e[r[c]]));if(l=Object.values(l),o=Math.max(...l),10*(s=Math.round(10*(o+.1))/10)%2==1&&(s=Math.round(10*(s+.1))/10),s===-1/0)for(s=.4;i<=s;)d.push(i),i+=.1,i=Math.round(10*(i+.1))/10;else if(s>=1.5)for(s=1.5*Math.round(s/1.5)+1;i<=s;)d.push(i),i+=.5,i=Math.round(i+.5);else for(;i<=s;)d.push(i),i+=.1,i=Math.round(10*(i+.1))/10;var u=d3.scaleLinear().domain([0,s]).range([a[2],a[2]-a[2]/1.15]);return[u,d3.axisLeft(u).tickValues(d).tickFormat(d3.format(".1f")).tickSizeOuter(0)]}function donutContruction(e,t,n,a,r,o){var s,l,i,d,c=Math.min(.8*r[1],.8*o[1])/2;s="default"===t?seasonStatsClean[seasonStatsClean.length-1]:seasonStatsClean[t],l={"Fly Out":Number(s.ao),"Ground Out":Number(s.go),"Strike Out":Number(s.so)},i=d3.sum([l["Fly Out"],l["Ground Out"],l["Strike Out"]]),d=d3.scaleOrdinal().domain(l).range(["#1D45A7","#B9455D","#008806"]);var u=d3.pie().value(function(e){return e.value}).sort(null)(d3.entries(l)),m=d3.arc().innerRadius(function(){return r[1]<=450?80:100}).outerRadius(function(){return r[1]<=450?.85*c:c});if("yes"===e){var g=n.attr("width",r[1]).attr("height",o[1]).append("g").attr("transform","translate("+r[1]/2+","+o[1]/2+")").attr("class","donut-chart-group");g.selectAll("g").data(u).enter().append("path").on("mousemove",function(e){a.style("left",d3.event.pageX+10+"px"),a.style("top",d3.event.pageY-25+"px"),a.style("display","inline-block"),a.html(e.data.key+"<br>"+Math.round(e.data.value/i*1e3)/10+"%")}).on("mouseout",function(e){a.style("display","none")}).attr("d",m).attr("fill",function(e){return d(e.data.key)}).attr("opacity","0").transition().ease(d3.easeBounceOut).duration(950).delay(200).attr("opacity","0.7").attrTween("d",function(e){e.innerRadius=0;var t=d3.interpolate({startAngle:0,endAngle:0},e);return function(e){return m(t(e))}}).attr("stroke","black").attr("class","donut-arcs").style("stroke-width","1px").each(function(e){this._current=e});var h=g.selectAll(".legend").data(d.domain()).enter().append("g").attr("class","circle-legend").attr("transform",function(e,t){return"translate(-39,"+(21*t-(21*d.domain().length/2-3))+")"});h.append("circle").style("fill",d).style("stroke",d).style("opacity",.7).attr("cx",0).attr("cy",0).attr("r",function(){return r[1]<=350?".28rem":".35rem"}).style("opacity","0").transition().duration(1e3).style("opacity","0.7"),h.append("text").attr("x",19).attr("y",7).text(function(e){return e}).style("opacity","0").transition().duration(1e3).style("opacity","1")}else{var b=d3.select("svg.donut-chart").selectAll("path").data(u);b.transition().ease(d3.easeBounceOut).duration(275).delay(75).attrTween("d",function(e){var t=d3.interpolate(this._current,e);return this._current=t(0),function(e){return m(t(e))}}),b.enter().append("path").attr("class","arc").attr("fill",function(e,t){return d(t)}).attr("d",m).each(function(e){this._current=e}),b.on("mousemove",function(e){a.style("left",d3.event.pageX+10+"px"),a.style("top",d3.event.pageY-25+"px"),a.style("display","inline-block"),a.html(e.data.key+"<br>"+Math.round(e.data.value/i*1e3)/10+"%")}).on("mouseout",function(e){a.style("display","none")})}}function barConstruction(e,t,n,a,r,o,s,l){var i,d=document.getElementsByClassName("grid-item")[0].innerText.slice(11),c=d3.scaleLinear().domain([d3.min(seasonStatsClean,e=>Number(e.season)-1),d3.max(seasonStatsClean,e=>Number(e.season)+1)]).range([45,r[0]-50]),u=d3.axisBottom(c).tickValues(o).tickFormat(function(e){return String(e)}).tickPadding(2.5).tickSizeOuter(0);if("default"===t)if("P"!==d)var m="h";else m="w";else m=t;var g=barYCoordInit(c,u,r,a,m),h=g[0],b=g[1];if(e.attr("width",r[0]-5).attr("height",5*a[0]/6),e.append("g").attr("transform","translate( 45, -25)").attr("x",0).attr("id","y-axis").transition().duration(1e3).call(b),e.append("g").attr("class","bar-gridlines").attr("transform","translate( 45, -25)").transition().duration(1e3).call(g[2].tickSize(95-r[0]).tickFormat("")),e.append("g").attr("transform","translate(0,"+String(a[0]-25)+")").transition().duration(1e3).call(u).attr("class","bar-x-axis"),document.querySelector("body").offsetWidth<=375)var p=22;else p=30;e.append("g").attr("class","bars-group").selectAll(".bars").data(seasonStatsClean).enter().append("rect").attr("x",(e,t)=>c(Number(e.season))-p/2).attr("y",h(0)-25).attr("width",p).attr("height",a[0]-h(0)).attr("class","bars").on("click",(e,t)=>{var n=d3.select("svg.donut-chart"),o=d3.select("div.donut-tooltip");d3.select("p.seasonNum")._groups[0][0].innerHTML="",d3.select("p.seasonNum")._groups[0][0].innerHTML="&nbsp"+e.season,barsIndexClicked=t,donutContruction("no",t,n,o,r,a)}).transition().duration(400).ease(d3.easeBounce).attr("height",(e,t)=>a[0]-h(Number(e[m]))).attr("y",(e,t)=>h(Number(e[m]))-25).delay(function(e,t){return 100*t+30}),e.append("g").attr("class","benchmark-group").selectAll("path").data(seasonStatsClean).enter().append("path").attr("class","benchmark").style("stroke","d45d79").style("opacity","0").style("stroke-width",1.75).attr("d",function(e,t){i="P"!==d?n[m]*(Number(e.g)/162):n[m]*((Number(e.g)+Number(e.gs))/68);var a="M"+(c(Number(e.season))-p/2-2)+","+(h(i)-25);return a+="L"+(c(Number(e.season))+p/2+2)+","+(h(i)-25)}),e.selectAll("path").transition().duration(300).delay(1100).style("opacity",".9"),e.append("g").attr("class","bar-label-group").selectAll("text").data(seasonStatsClean).enter().append("text").text((e,t)=>e[m]).attr("x",(e,t)=>e[m].length>=3?c(Number(e.season))-11:2===e[m].length?c(Number(e.season))-7:1===e[m].length?c(Number(e.season))-3.5:void 0).attr("y",(e,t)=>h(Number(e[m]))-30).attr("class","bar-value").style("opacity","0"),e.selectAll("text").transition().duration(300).delay(1100).style("opacity","1"),setTimeout(function(){a[0]<=0&&(d3.select("#bar-chart").selectAll("svg").remove(),d3.select("#donut-chart").selectAll("svg").remove(),d3.select("#line-chart").selectAll("svg").remove(),dashboardBuilder(t),fadeIn(s,"inline-block",10),fadeIn(l,"inline-block",10))},80),setTimeout(function(){"0"===s.style.opacity&&(fadeIn(s,"inline-block",10),fadeIn(l,"inline-block",10))},300)}function updateBar(e,t,n,a,r,o,s,l){var i,d=document.getElementsByClassName("grid-item")[0].innerText.slice(11),c=e,u=d3.scaleLinear().domain([d3.min(seasonStatsClean,e=>Number(e.season)-1),d3.max(seasonStatsClean,e=>Number(e.season)+1)]).range([45,n[0]-50]),m=d3.axisBottom(u).tickValues(r).tickFormat(function(e){return String(e)}).tickPadding(2.5).tickSizeOuter(0),g=barYCoordInit(u,m,n,a,c),h=g[0],b=g[1];if(document.querySelector("body").offsetWidth<=375)var p=22;else p=30;t.select(".bar-gridlines").transition().duration(500).call(g[2].tickSize(95-n[0]).tickFormat("")),t.select("#y-axis").transition().duration(1e3).call(b),d3.select(".bars-group").selectAll(".bars").data(seasonStatsClean).transition().ease(d3.easeBounce).duration(250).attr("height",(e,t)=>a[0]-h(Number(e[c]))).attr("y",(e,t)=>h(Number(e[c]))-25).delay(function(e,t){return 50*t}),t.select(".benchmark-group").selectAll("path.benchmark").data(seasonStatsClean).transition().duration(275).attr("d",function(e,t){i="P"!==d?o[c]*(Number(e.g)/162):o[c]*((Number(e.g)+Number(e.gs))/68);var n="M"+(u(Number(e.season))-p/2-2)+","+(h(i)-25);return n+="L"+(u(Number(e.season))+p/2+2)+","+(h(i)-25)}).delay(function(e,t){return 50*t+80}),t.select(".bar-label-group").selectAll("text.bar-value").data(seasonStatsClean).transition().duration(275).text((e,t)=>e[c]).attr("x",(e,t)=>e[c].length>=3?u(Number(e.season))-11:2===e[c].length?u(Number(e.season))-7:1===e[c].length?u(Number(e.season))-3.5:void 0).attr("y",(e,t)=>h(Number(e[c]))-30).delay(function(e,t){return 50*t+80}),setTimeout(function(){"0"===s.style.opacity&&(fadeIn(s,"inline-block",10),fadeIn(l,"inline-block",10))},300)}function lineConstruction(e,t,n,a){for(var r=document.getElementsByClassName("grid-item")[0].innerText.slice(11),o=d3.scaleLinear().domain([d3.min(seasonStatsClean,e=>Number(e.season)-1),d3.max(seasonStatsClean,e=>Number(e.season)+1)]).range([45,Math.round(7*t[2]/8)]),s=d3.axisBottom(o).tickValues(a).tickFormat(function(e){return String(e)}).tickPadding(2.5).tickSizeOuter(0),l=[],i=document.querySelectorAll("input.line-chart-options"),d=0;d<i.length;d++)i[d].checked&&"K%"===i[d].value?l.push("kpct"):i[d].checked&&"K%"!==i[d].value&&l.push(i[d].value.toLowerCase());var c=lineYCoordInit(o,s,t,n,l),u=c[0],m=c[1];e.attr("width",Math.round(7*t[2]/8)).attr("height",5*n[2]/6),e.append("g").attr("transform","translate( 45, -25)").attr("x",0).attr("id","line-y-axis").transition().duration(1e3).call(m),e.append("g").attr("transform","translate(0,"+String(n[2]-25)+")").transition().duration(1e3).call(s).attr("class","line-x-axis");var g=e.append("g").attr("class","line-chart-group"),h=d3.select("#line-y-axis").selectAll(".tick").select("text")._groups[0].length,b={};if(linePreMax=d3.select("#line-y-axis").selectAll(".tick").select("text")._groups[0][h-1].innerHTML,"P"!==r)var p={avg:"#1D45A7",slg:"#B9455D",obp:"#008806",ops:"#FF823D"};else p={kpct:"#1D45A7",era:"#B9455D",whip:"#008806"};for(d=0;d<i.length;d++)"K%"===i[d].value?b.kpct=p.kpct:b[i[d].value.toLowerCase()]=p[i[d].value.toLowerCase()];for(var y=d3.scaleOrdinal().domain(Object.keys(b)).range(Object.values(b)),f=0;f<l.length;f++){var v=d3.line().x(function(e,t){return o(Number(e.season))}).y(function(e){return u(Number(e[l[f]]))-25});g.append("path").datum(seasonStatsClean).attr("fill","none").attr("stroke",function(e){return y(l[f])}).attr("stroke-width",2.5).attr("class","line "+l[f]).attr("opacity","0.8").attr("d",v)}var N=e.append("rect").attr("x",45).attr("y",20).attr("width",Math.round(7*t[2]/8)-45).attr("height",n[2]/1.15).attr("opacity",0).attr("class","line-tooltip-container").on("mousemove",function(){var e=1*Math.floor((o.invert(d3.mouse(N.node())[0])+.5)/1);e<seasonStatsClean[0].season?e=seasonStatsClean[0].season:e>seasonStatsClean[seasonStatsClean.length-1].season&&(e=seasonStatsClean[seasonStatsClean.length-1].season);if(void 0===seasonStatsClean.find(t=>Number(t.season)===e))return _.attr("stroke","none"),void S.style("display","none");_.attr("stroke","black").attr("opacity","0.8").attr("x1",o(e)+.5).attr("x2",o(e)+.5).attr("y1",u(0)-25).attr("y2",n[2]-n[2]/1.15-25).style("stroke-dasharray","4, 4"),l.sort(function(t,n){return seasonStatsClean.find(t=>Number(t.season)===Math.floor(e))[n]-seasonStatsClean.find(t=>Number(t.season)===Math.floor(e))[t]}),S.html("<span><u>"+e+" Season</u></span>").style("display","block").style("left",d3.event.pageX+20+"px").style("top",d3.event.pageY-20+"px").selectAll().data(l).enter().append("div").style("color",function(e){return p[e]}).attr("class","tooltip-contents").html(function(t){return"kpct"===t?"K% "+String(Math.round(1e3*Number(seasonStatsClean.find(t=>Number(t.season)===Math.floor(e))[t]))/10)+"%":t.toUpperCase()+" "+seasonStatsClean.find(t=>Number(t.season)===Math.floor(e))[t]})}).on("mouseout",function(){_.attr("stroke","none"),S.style("display","none")}),S=d3.select("body").append("div").attr("class","line-tooltip").style("display","none"),_=e.append("line").attr("class","line-tooltip-dash");function I(){var e=this.getTotalLength(),t=d3.interpolateString("0,"+e,e+","+e);return function(e){return t(e)}}d3.selectAll("path.line").each(function(){d3.select(this).transition().duration(1e3).ease(d3.easeCubic).attrTween("stroke-dasharray",I)});var k=e.selectAll(".line-legend").data(y.domain()).enter().append("g").attr("class",function(e){return"line-legend -"+e}).attr("transform",function(e,a){return"translate("+(t[2]-55-10)+","+(n[2]/1.5+18*a)+")"});for(d=0;d<i.length;d++){var B=t[2]-55-10,E=n[2]/1.5+18*d;lineLegPos.push("translate("+B+","+E+")"),i[d].checked||("K%"!==i[d].value?d3.select(".line-legend.-"+i[d].value.toLowerCase()).attr("display","none"):d3.select(".line-legend.-kpct").attr("display","none"))}for(d=0;d<lineLegNew.length;d++)d3.select(".line-legend.-"+lineLegNew[d]).attr("transform",lineLegPos[d]);k.append("circle").style("fill",y).style("stroke",y).style("opacity",1).attr("cx",0).attr("cy",0).attr("r",function(){return t[1]<=350?".2rem":".25rem"}).style("opacity","0").transition().duration(1e3).style("opacity","0.8"),k.append("text").attr("x",11.5).attr("y",4.5).attr("class","line-text").text(function(e){return"kpct"===e?"K%":e.toUpperCase()}).style("opacity","0").transition().duration(1e3).style("opacity","1")}function updateLine(e,t,n,a,r,o){for(var s=document.getElementsByClassName("grid-item")[0].innerText.slice(11),l=d3.scaleLinear().domain([d3.min(seasonStatsClean,e=>Number(e.season)-1),d3.max(seasonStatsClean,e=>Number(e.season)+1)]).range([45,Math.round(7*a[2]/8)]),i=d3.axisBottom(l).tickValues(o).tickFormat(function(e){return String(e)}).tickPadding(2.5).tickSizeOuter(0),d=[],c={},u=0;u<t.length;u++)t[u].checked&&"K%"===t[u].value?d.push("kpct"):t[u].checked&&"K%"!==t[u].value&&d.push(t[u].value.toLowerCase());var m=lineYCoordInit(l,i,a,r,d),g=m[0],h=m[1];if("P"!==s)var b={avg:"#1D45A7",slg:"#B9455D",obp:"#008806",ops:"#FF823D"};else b={kpct:"#1D45A7",era:"#B9455D",whip:"#008806"};for(u=0;u<t.length;u++)t[u].checked&&"K%"===t[u].value?c.kpct=b.kpct:t[u].checked&&"K%"!==t[u].value&&(c[t[u].value.toLowerCase()]=b[t[u].value.toLowerCase()]);var p=d3.scaleOrdinal().domain(Object.keys(c)).range(Object.values(c));n.select("#line-y-axis").transition().duration(1e3).call(h);var y=d3.select("#line-y-axis").selectAll(".tick").select("text")._groups[0].length,f=d3.select("#line-y-axis").selectAll(".tick").select("text")._groups[0][y-1].innerHTML,v=d3.select("g.line-chart-group");if(e.checked&&"K%"===e.value)var N="kpct";else if(e.checked)N=e.value.toLowerCase();if(e.checked){var S=d3.line().x(function(e,t){return l(Number(e.season))}).y(function(e){return g(Number(e[N]))-20});v.append("path").datum(seasonStatsClean).attr("fill","none").attr("stroke",function(e){return p(N)}).attr("stroke-width",2.5).attr("class","line "+N).attr("opacity","0.8").attr("d",S),d3.select(".line-legend.-"+N).attr("display","inline-block")}Number(f)!==Number(linePreMax)&&(linePreMax=f,d3.select(".dot-chart-group").selectAll("circle").attr("opacity","0"));for(var _=0;_<d.length;_++){var I;d3.select(".line-chart-group").selectAll("path.line."+d[_]).datum(seasonStatsClean).transition().duration(1e3).ease(d3.easeCubic).attr("d",d3.line().x(function(e,t){return l(Number(e.season))}).y(function(e){return g(Number(e[d[_]]))-25})).on("end",function(){I=this.getTotalLength()}).attr("stroke-dasharray",String(I)+","+String(I))}var k=n.append("rect").attr("x",45).attr("y",20).attr("width",Math.round(7*a[2]/8)-45).attr("height",r[2]/1.15).attr("opacity",0).attr("class","line-tooltip-container").on("mousemove",function(){var e=1*Math.floor((l.invert(d3.mouse(k.node())[0])+.5)/1);e<seasonStatsClean[0].season?e=seasonStatsClean[0].season:e>seasonStatsClean[seasonStatsClean.length-1].season&&(e=seasonStatsClean[seasonStatsClean.length-1].season);if(void 0===seasonStatsClean.find(t=>Number(t.season)===e))return E.attr("stroke","none"),void B.style("display","none");E.attr("stroke","black").attr("opacity","0.8").attr("x1",l(e)+.5).attr("x2",l(e)+.5).attr("y1",g(0)-25).attr("y2",r[2]-r[2]/1.15-25).style("stroke-dasharray","4, 4"),d.sort(function(t,n){return seasonStatsClean.find(t=>Number(t.season)===Math.floor(e))[n]-seasonStatsClean.find(t=>Number(t.season)===Math.floor(e))[t]}),B.html("<span><u>"+e+" Season</u></span>").style("display","block").style("left",d3.event.pageX+20+"px").style("top",d3.event.pageY-20+"px").selectAll().data(d).enter().append("div").style("color",function(e){return b[e]}).attr("class","tooltip-contents").html(function(t){return"kpct"===t?"K% "+String(Math.round(1e3*Number(seasonStatsClean.find(t=>Number(t.season)===Math.floor(e))[t]))/10)+"%":t.toUpperCase()+" "+seasonStatsClean.find(t=>Number(t.season)===Math.floor(e))[t]})}).on("mouseout",function(){E.attr("stroke","none"),B.style("display","none")}),B=d3.select("body").append("div").attr("class","line-tooltip").style("display","none"),E=n.append("line").attr("class","line-tooltip-dash")}pageLoader(),document.getElementById("search-bar").addEventListener("keyup",function(e){"Enter"===e.key&&search(),""!==document.getElementById("search-bar").value?"1"!==document.getElementById("search-icon").style.opacity&&fadeIn(document.getElementById("search-icon"),"inline-block",5):fadeOut(document.getElementById("search-icon"),5)}),document.getElementById("search-icon").addEventListener("click",function(){search()}),document.getElementById("toggle").addEventListener("click",function(){var e=document.getElementsByClassName("toggle-label")[0];document.getElementById("toggle").checked?e.innerHTML="Active player":e.innerHTML="Inactive player"}),document.getElementById("return-btn").addEventListener("click",function(){var e=document.getElementById("search-pane");document.getElementById("search-bar").value="",seasonDataStopper=!1,resetContent(),++resetTimer>6?location.reload():fadeIn(e,"block",17)}),document.getElementById("error-close-btn").addEventListener("click",function(){var e=document.getElementById("error-msg"),t=document.getElementById("search-pane"),n=document.getElementById("return-btn");fadeOut(e,20),fadeIn(t,"block",17),fadeOut(n,17)}),document.getElementById("system-error-close-btn").addEventListener("click",function(){var e=document.getElementById("system-error-msg"),t=document.getElementById("search-pane"),n=document.getElementById("return-btn");fadeOut(e,20),fadeIn(t,"block",17),fadeOut(n,17)}),document.getElementById("glossary-close-btn").addEventListener("click",function(){var e=document.getElementById("glossary"),t=document.getElementById("dash-header"),n=document.querySelectorAll(".grid-item")[0].innerText.slice(-1),a=document.getElementById("pitcher-metrics"),r=document.getElementById("batter-metrics"),o=document.getElementById("blocker");o.parentNode.removeChild(o),fadeOut("P"===n?a:r,17),fadeOut(e,17),t.style.opacity="1"}),document.getElementById("dash-btn").addEventListener("click",function(){var e=document.getElementById("dashboard-container"),t=document.getElementById("return-btn"),n=document.getElementById("return-text");"grid"!==e.style.display?(fadeOut(t,14),fadeOut(n,14),fadeIn(e,"grid",16),scrollDown("dashboard-container",16),setTimeout(function(){seasonStats(playerId,currentSeason)},450)):scrollDown("dashboard-container",16)}),document.getElementById("glossary-btn").addEventListener("click",function(){var e=document.getElementById("glossary"),t=document.getElementById("glossary-content"),n=document.getElementById("dash-header"),a=document.querySelectorAll(".grid-item")[0].innerText.slice(-1),r=document.getElementById("pitcher-metrics"),o=document.getElementById("batter-metrics"),s=document.createElement("div");s.setAttribute("id","blocker"),document.body.appendChild(s),"inline-block"!==e.style.display&&(fadeIn(e,"inline-block",14),setTimeout(function(){t.scrollTo(0,0)},14),fadeIn("P"===a?r:o,"inline-block",14),setTimeout(function(){n.style.opacity="0.3"},30))});
